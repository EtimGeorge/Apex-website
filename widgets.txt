      // Only allow updates to increment the likeCount
      allow update: if request.resource.data.likeCount == resource.data.likeCount + 1;

      // Allow an admin to create a post directly from the client.
      // This rule checks if the user has an `isAdmin: true` flag in their user document
      // and validates the data being sent.
      allow create: if get(/databases/$(database)/documents/users/$(request.auth.uid)).data.isAdmin == true
                    && request.resource.data.title is string
                    && request.resource.data.snippet is string
                    && request.resource.data.content is string
                    && request.resource.data.status in ['published', 'draft']
                    && request.resource.data.likeCount == 0
                    && request.resource.data.authorId == request.auth.uid
                    && request.resource.data.createdAt == request.time;

      // Rules for the Comments subcollection
      match /comments/{commentId} {

